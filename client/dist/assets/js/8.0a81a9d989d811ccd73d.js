(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{151:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),a=n(3),i=n(28),s=n(16),c=n(2),u=n(29),l=n(17),p=n.n(l),f=n(13);function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v(t);if(e){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}function y(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?g(t):e}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var S=Object(s.b)((function(t){return{login:t.popup.login}}),(function(t){return{onLogin:function(e){return t(Object(u.b)(e))},onSubmit:function(){return t({type:c.l})},submitDone:function(){return t({type:c.m})},loginDone:function(){return t({type:c.b})}}}))(Object(a.f)(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(i,t);var e,n,r,a=b(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).state={placeholder:"",isDisabled:!1,inputStyle:"input-border ",email:"",password:"",errorMessage:""},e.submitHandler=e.submitHandler.bind(g(e)),e.inputHandler=f.d.bind(g(e)),e.validatePwd=f.o.bind(g(e)),e.validateEmail=f.m.bind(g(e)),e}return e=i,(n=[{key:"submitHandler",value:function(t){var e=this;t.preventDefault();var n=this.state,r=n.email,o=n.password,a="input-border input-border--error",i=this.validateEmail(r,"emailInput",a),s=this.validatePwd(o,"pwdInput",a);if(i&&s){this.props.onSubmit(),this.setState({isDisabled:!0});var c={email:r,password:o};p.a.request({url:"http://localhost:9000/api/user/login",method:"POST",data:c}).then((function(t){var n=t.data.token;localStorage.setItem("jwtToken",n),e.props.onLogin(n),e.setState({successMessage:t.data.message,errorMessage:""}),e.props.loginDone()})).catch((function(t){e.setState({successMessage:"",errorMessage:t.response.data.message,isDisabled:!1,inputStyle:"input-border "}),e.form.reset()})).finally(this.props.submitDone())}}},{key:"UNSAFE_componentWillUpdate",value:function(t,e){t.login||(this.pwdInput.className=this.state.inputStyle,this.emailInput.className=this.state.inputStyle,this.form.reset(),e.errorMessage="")}},{key:"render",value:function(){var t=this,e=this.state,n=e.isDisabled,r=e.inputStyle,a=e.errorMessage,i=n?"disabled":"";return o.a.createElement(o.a.Fragment,null,!a&&o.a.createElement("div",{className:"content__noti--default"}),a&&o.a.createElement("div",{className:"content__noti--error"},a),o.a.createElement("form",{ref:function(e){return t.form=e}},o.a.createElement("input",{ref:function(e){return t.emailInput=e},name:"email",className:r,placeholder:"Email",type:"email",disabled:i,onChange:this.inputHandler}),o.a.createElement("input",{ref:function(e){return t.pwdInput=e},name:"password",className:r,placeholder:"Password",disabled:i,onChange:this.inputHandler,type:"password"}),o.a.createElement("a",{className:"btn-link",onClick:this.props.reset},"Forget password?"),o.a.createElement("input",{className:"btn-primary",type:"submit",value:"Log in",disabled:i,onClick:this.submitHandler})))}}])&&d(e.prototype,n),r&&d(e,r),i}(r.Component)));function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j(t);if(e){var o=j(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return O(this,n)}}function O(t,e){return!e||"object"!==N(e)&&"function"!=typeof e?k(t):e}function k(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var C=Object(s.b)((function(t){return{register:t.popup.register}}),(function(t){return{onSubmit:function(){return t({type:c.l})},submitDone:function(){return t({type:c.m})}}}))(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(i,t);var e,n,r,a=E(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).state={placeholder:"",isDisabled:!1,inputStyle:"input-border ",email:"",password:"",passwordCheck:"",name:"",errorMessage:"",successMessage:""},e.submitHandler=e.submitHandler.bind(k(e)),e.inputHandler=f.d.bind(k(e)),e.validateName=f.n.bind(k(e)),e.validatePwd=f.o.bind(k(e)),e.validateEmail=f.m.bind(k(e)),e.checkMatchPwd=f.b.bind(k(e)),e}return e=i,(n=[{key:"UNSAFE_componentWillUpdate",value:function(t,e){t.register||(this.pwdInput.className=this.state.inputStyle,this.emailInput.className=this.state.inputStyle,this.nameInput.className=this.state.inputStyle,this.pwdCheckInput.className=this.state.inputStyle,this.form.reset(),e.errorMessage="",e.successMessage="")}},{key:"submitHandler",value:function(t){var e=this;t.preventDefault();var n=this.state,r=n.name,o=n.email,a=n.password,i=n.passwordCheck,s="input-border input-border--error",c=this.validateName(r,"nameInput",s),u=this.validateEmail(o,"emailInput",s),l=this.validatePwd(a,"pwdInput",s),f=this.validatePwd(i,"pwdCheckInput",s),m=!1;if(l&&f&&(m=this.checkMatchPwd(a,"pwdInput",i,"pwdCheckInput",s)),c&&u&&l&&f&&m){this.props.onSubmit(),this.setState({isDisabled:!0});var d={email:o,name:r,password:a};p.a.request({url:"http://localhost:9000/api/user/register",method:"POST",data:d}).then((function(t){var n=t.data.message;e.setState({successMessage:n})})).catch((function(t){var n=t.response.data.message;e.setState({errorMessage:n})})).finally((function(){e.props.submitDone(),e.form.reset(),e.setState({isDisabled:!1,inputStyle:"input-border "})}))}}},{key:"render",value:function(){var t=this,e=this.state,n=e.isDisabled,r=e.inputStyle,a=e.successMessage,i=e.errorMessage,s=n?"disabled":"";return o.a.createElement(o.a.Fragment,null,!i&&!a&&o.a.createElement("div",{className:"content__noti--default"}),i&&o.a.createElement("div",{className:"content__noti--error"},i),a&&o.a.createElement("div",{className:"content__noti"},a),o.a.createElement("form",{ref:function(e){return t.form=e}},o.a.createElement("input",{ref:function(e){return t.nameInput=e},name:"name",className:r,disabled:s,onChange:this.inputHandler,placeholder:"Name (Maximum 20 characters)"}),o.a.createElement("input",{ref:function(e){return t.emailInput=e},type:"email",name:"email",className:r,disabled:s,onChange:this.inputHandler,placeholder:"Email"}),o.a.createElement("input",{ref:function(e){return t.pwdInput=e},name:"password",type:"password",className:r,disabled:s,onChange:this.inputHandler,placeholder:"Password"}),o.a.createElement("input",{ref:function(e){return t.pwdCheckInput=e},name:"passwordCheck",type:"password",className:r,disabled:s,onChange:this.inputHandler,placeholder:"Password confirmation"}),o.a.createElement("input",{className:"btn-primary",type:"submit",value:"Register",disabled:s,onClick:this.submitHandler})))}}])&&w(e.prototype,n),r&&w(e,r),i}(r.Component));function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function U(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=A(t);if(e){var o=A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return D(this,n)}}function D(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?M(t):e}function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var T=Object(s.b)((function(t){return{reset:t.popup.reset}}),(function(t){return{onSubmit:function(){return t({type:c.l})},submitDone:function(){return t({type:c.m})}}}))(Object(a.f)(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(i,t);var e,n,r,a=U(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).state={placeholder:"",isDisabled:!1,inputStyle:"input-border ",email:"",password:"",errorMessage:""},e.submitHandler=e.submitHandler.bind(M(e)),e.inputHandler=f.d.bind(M(e)),e.validateEmail=f.m.bind(M(e)),e}return e=i,(n=[{key:"submitHandler",value:function(t){var e=this;t.preventDefault();var n=this.state.email;if(this.validateEmail(n,"emailInput","input-border input-border--error")){this.props.onSubmit(),this.setState({isDisabled:!0});var r={email:n};p.a.post("http://localhost:9000/api/user/reset-password",r).then((function(t){var n=t.data.message;e.setState({successMessage:n})})).catch((function(t){var n=t.message||t.response.data.message;e.setState({errorMessage:n})})).finally((function(){e.props.submitDone(),e.form.reset(),e.setState({isDisabled:!1,inputStyle:"input-border "})}))}}},{key:"UNSAFE_componentWillUpdate",value:function(t,e){t.reset||(this.emailInput.className=this.state.inputStyle,this.form.reset(),e.errorMessage="",e.successMessage="")}},{key:"render",value:function(){var t=this,e=this.state,n=e.isDisabled,r=e.inputStyle,a=e.errorMessage,i=e.successMessage,s=n?"disabled":"";return o.a.createElement(o.a.Fragment,null,!a&&!i&&o.a.createElement("div",{className:"content__noti--default"}),a&&o.a.createElement("div",{className:"content__noti--error"},a),i&&o.a.createElement("div",{className:"content__noti"},i),o.a.createElement("form",{ref:function(e){return t.form=e}},o.a.createElement("input",{ref:function(e){return t.emailInput=e},name:"email",className:r,placeholder:"Email",type:"email",disabled:s,onChange:this.inputHandler}),o.a.createElement("input",{className:"btn-primary",type:"submit",value:"Reset password",disabled:s,onClick:this.submitHandler})))}}])&&I(e.prototype,n),r&&I(e,r),i}(r.Component)));function H(t){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=B(t);if(e){var o=B(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return z(this,n)}}function z(t,e){return!e||"object"!==H(e)&&"function"!=typeof e?W(t):e}function W(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var G=Object(s.b)((function(t){return{isOpen:t.popup.isOpen,login:t.popup.login,register:t.popup.register,isDisabled:t.popup.isDisabled,reset:t.popup.reset}}),(function(t){return{onClose:function(){return t({type:c.b})},onLogin:function(){return t({type:c.i})},onRegister:function(){return t({type:c.j})},onReset:function(){return t({type:c.k})}}}))(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(i,t);var e,n,r,a=x(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).login=e.login.bind(W(e)),e.reset=e.reset.bind(W(e)),e.register=e.register.bind(W(e)),e}return e=i,(n=[{key:"UNSAFE_componentWillUpdate",value:function(t,e){t.isOpen&&t.login&&this.login,t.isOpen&&t.register&&this.register}},{key:"login",value:function(){this.props.onLogin(),this.loginForm.style.left="0",this.registerForm.style.left="30rem",this.resetForm.style.left="-30rem",this.btn.style.left="0"}},{key:"reset",value:function(){this.props.onReset(),this.loginForm.style.left="-30rem",this.resetForm.style.left="0"}},{key:"register",value:function(){this.props.onRegister(),this.resetForm.style.left="-30rem",this.loginForm.style.left="-30rem",this.registerForm.style.left="0",this.btn.style.left="9rem"}},{key:"render",value:function(){var t=this,e=!!this.props.isDisabled&&"disabled";return o.a.createElement(o.a.Fragment,null,this.props.isOpen&&o.a.createElement("section",{className:"popup"},o.a.createElement("div",{className:"popup__content"},o.a.createElement("div",{className:"popup__close"},o.a.createElement("div",{className:"close-btn",onClick:this.props.onClose},o.a.createElement("div",{className:"close-btn__leftright close-line"}),o.a.createElement("div",{className:"close-btn__rightleft close-line"}),o.a.createElement("label",{className:"close-btn__title"},"close"))),o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"content__toggle-btn"},o.a.createElement("div",{ref:function(e){return t.btn=e},className:"toggle-btn__effect"}),o.a.createElement("button",{className:"toggle-btn__btn",disabled:e,onClick:this.login},"Log in"),o.a.createElement("button",{className:"toggle-btn__btn",disabled:e,onClick:this.register},"Register")),o.a.createElement("div",{className:"content__form"},o.a.createElement("div",{ref:function(e){return t.resetForm=e},className:"reset-form"},o.a.createElement(T,null)),o.a.createElement("div",{ref:function(e){return t.loginForm=e},className:"login-form"},o.a.createElement(S,{reset:this.reset})),o.a.createElement("div",{ref:function(e){return t.registerForm=e},className:"register-form"},o.a.createElement(C,{logIn:this.login})))))))}}])&&F(e.prototype,n),r&&F(e,r),i}(r.Component)),q=n.p+"assets/img/logout.c6832ba4d650d3e73aca0aab18912dd0.png",J=n.p+"assets/img/white-logout.5603744490bed79f02ca8d7117e79683.png";function $(){return($=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var V=r.createElement("path",{d:"M230 49.585c0-.263.181-.519.169-.779l-70.24 67.68 70.156 65.518c.041-.468-.085-.94-.085-1.418V49.585zM149.207 126.901l-28.674 27.588a7.48 7.48 0 01-5.2 2.096 7.478 7.478 0 01-5.113-2.013l-28.596-26.647-70.614 68.064c1.717.617 3.56 1.096 5.49 1.096h197.667c2.866 0 5.554-.873 7.891-2.175l-72.851-68.009z","data-original":"#000000",className:"mail_svg__active-path"}),K=r.createElement("path",{d:"M115.251 138.757L222.447 35.496c-2.427-1.443-5.252-2.411-8.28-2.411H16.5c-3.943 0-7.556 1.531-10.37 3.866l109.121 101.806zM0 52.1v128.484c0 1.475.339 2.897.707 4.256l69.738-67.156L0 52.1z","data-original":"#000000",className:"mail_svg__active-path"});var Q=function(t){return r.createElement("svg",$({viewBox:"0 0 230.17 230.17",width:512,height:512},t),V,K)},X=n(137),Y=n.n(X);function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t){return function(t){if(Array.isArray(t))return et(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rt(t,e){return(rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=st(t);if(e){var o=st(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return at(this,n)}}function at(t,e){return!e||"object"!==Z(e)&&"function"!=typeof e?it(t):e}function it(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ct=Object(s.b)((function(t){return{isOpen:t.popup.isOpen,isLoggedIn:t.currentUser.isLoggedIn,currentUser:t.currentUser.userData,socket:t.socket.socket}}),(function(t){return{jumpToComment:function(e,n,r){return t(function(t,e,n){return{type:c.d,payload:{commentId:t,isReply:e,date:n}}}(e,n,r))}}}))(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rt(t,e)}(s,t);var e,n,r,a=ot(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this,t)).state={notifications:[],unReadNotis:0,pageSize:0,hasChange:!1,notisTotal:0},e.setInfo=e.setInfo.bind(it(e)),e.readNoti=e.readNoti.bind(it(e)),e.handleScroll=e.handleScroll.bind(it(e)),e.mustGetNotifications=e.mustGetNotifications.bind(it(e)),e.loadNotifications=e.loadNotifications.bind(it(e)),e}return e=s,(n=[{key:"readNoti",value:function(t,e,n,r,o){this.props.socket.emit("readNoti",{notiId:t}),n&&this.props.jumpToComment(e,r,o)}},{key:"UNSAFE_componentWillUpdate",value:function(t,e){e.hasChange&&e.hasChange!=this.state.hasChange&&this.mustGetNotifications(e)}},{key:"componentDidMount",value:function(){this.mustGetNotifications(this.state),this.loadNotifications()}},{key:"mustGetNotifications",value:function(t){this.props.socket.emit("getNotifications",{userId:this.props.currentUser.id,pageSize:t.pageSize,hasChange:t.hasChange})}},{key:"loadNotifications",value:function(){var t=this;this.props.socket.on("returnNotificationsOf".concat(this.props.currentUser.id),(function(e){if(e.error)t.setState({errorMessage:e.error});else{var n=t.state.notifications;!n.length||n&&t.state.hasChange?t.setState({notifications:e.listNotis,notisTotal:e.notisTotal,pageSize:e.listNotis.length,hasChange:!1,unReadNotis:e.unReadNotis}):t.setState({notifications:[].concat(tt(n),tt(e.listNotis)),notisTotal:e.notisTotal,pageSize:n.length+e.listNotis.length,unReadNotis:e.unReadNotis})}}))}},{key:"UNSAFE_componentWillMount",value:function(){var t=this;this.props.socket.on("hasChange".concat(this.props.currentUser.id),(function(){t.setState({hasChange:!0})}))}},{key:"handleScroll",value:function(t){var e=t.target.scrollHeight-t.target.scrollTop===t.target.clientHeight,n=this.state,r=n.notisTotal,o=n.pageSize;e&&r>o&&this.mustGetNotifications(this.state)}},{key:"componentWillUnmount",value:function(){this.props.socket.off("returnNotificationsOf".concat(this.props.currentUser.id)),this.props.socket.off("hasChange".concat(this.props.currentUser.id))}},{key:"setInfo",value:function(t){var e=t.post.name,n=t.post._id,r=t.date,o="unread"!=t.status;return t.rocks?{date:r,message:"<b>".concat(t.rocks.name,"</b> threw a rock at your <b>").concat(e,"</b> post"),avatar:t.rocks.avatar,postId:n,isRead:o,jumpToComment:!1,isReply:!1}:t.flowers?{date:r,message:"<b>".concat(t.flowers.name,"</b> gave a flower for your <b>").concat(e,"</b> post"),avatar:t.flowers.avatar,postId:n,isRead:o,jumpToComment:!1,isReply:!1}:t.replier?{date:r,message:"<b>".concat(t.replier.name,"</b> replied to your comment on <b>").concat(e,"</b> post"),avatar:t.replier.avatar,postId:n,isRead:o,jumpToComment:!0,isReply:!0}:{date:r,message:"<b>".concat(t.commenter.name,"</b> commented on your <b>").concat(e,"</b> post"),avatar:t.commenter.avatar,postId:n,isRead:o,jumpToComment:!0,isReply:!1}}},{key:"render",value:function(){var t=this,e=this.state,n=e.notifications,r=e.unReadNotis;return n&&!n.length?o.a.createElement("div",{className:"notifications"},o.a.createElement("h4",{className:"u-center-text u-text-bold u-center-el u-color-light"},"No notification found")):o.a.createElement("div",{className:"notifications",onScroll:this.handleScroll},o.a.createElement("div",{className:"notifications__unreads"},"Unread (".concat(r,")")),n.map((function(e){var n=t.setInfo(e),r=n.avatar,a=n.message,s=n.postId,c=n.isRead,u=n.jumpToComment,l=n.isReply,p=n.date,f=c?"notification":"notification--unread";return o.a.createElement(i.b,{onClick:function(){t.readNoti(e._id,e.comment,u,l,p)},to:"/destinations/".concat(s),className:f,key:e._id},o.a.createElement("img",{src:r,className:"notification__avatar"}),o.a.createElement("div",{className:"notification__content"},Y()(a)))})))}}])&&nt(e.prototype,n),r&&nt(e,r),s}(r.Component));function ut(t){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return pt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=yt(t);if(e){var o=yt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ht(this,n)}}function ht(t,e){return!e||"object"!==ut(e)&&"function"!=typeof e?bt(t):e}function bt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yt(t){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}e.default=Object(s.b)((function(t){return{isOpen:t.popup.isOpen,isLoggedIn:t.currentUser.isLoggedIn,currentUser:t.currentUser.userData,socket:t.socket.socket}}),(function(t){return{onOpen:function(){return t({type:c.h})},onLogout:function(){return t(Object(u.c)())},onChangeAvatar:function(e){return t(Object(u.a)(e))}}}))(Object(a.f)(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(s,t);var e,n,r,a=dt(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this,t)).state={successMessage:"",errorMessage:"",isOpen:!1,notifications:[]},e.logout=e.logout.bind(bt(e)),e.goBack=e.goBack.bind(bt(e)),e.toastNoti=f.i.bind(bt(e)),e.getCurrentAvatar=e.getCurrentAvatar.bind(bt(e)),e.updateSocket=f.k.bind(bt(e)),e.openNoti=e.openNoti.bind(bt(e)),e}return e=s,(n=[{key:"componentDidMount",value:function(){this.getCurrentAvatar(this.props.currentUser.id),this.props.isLoggedIn&&(this.props.socket.emit("getUnSeenNotis",this.props.currentUser.id),this.updateSocket("notifications","returnUnSeenNotisOf".concat(this.props.currentUser.id)))}},{key:"UNSAFE_componentWillMount",value:function(){this.updateSocket("notifications","returnUnSeenNotisOf".concat(this.props.currentUser.id))}},{key:"UNSAFE_componentWillUpdate",value:function(t,e){t.location!=this.props.location&&(e.isOpen=!1),t.isLoggedIn||(this.props.socket.off("returnCurrentAvatar"),this.props.socket.off("returnUnSeenNotisOf".concat(this.props.currentUser.id))),t.isLoggedIn&&t.isLoggedIn!=this.props.isLoggedIn&&(this.props.socket.emit("getUnSeenNotis",t.currentUser.id),this.updateSocket("notifications","returnUnSeenNotisOf".concat(t.currentUser.id)),this.getCurrentAvatar(t.currentUser.id))}},{key:"getCurrentAvatar",value:function(t){var e=this;this.props.socket.emit("getCurrentAvatar",t),this.props.socket.on("returnCurrentAvatar",(function(t){e.props.onChangeAvatar(t.avatar)}))}},{key:"openNoti",value:function(){var t=this.state,e=t.isOpen,n=t.notifications;n&&n.listNotis.length&&0==e&&this.props.socket.emit("seenAllNotis",this.props.currentUser.id),this.setState({isOpen:!e})}},{key:"logout",value:function(){localStorage.removeItem("jwtToken"),this.setState({notifications:"",isOpen:!1}),this.props.onLogout(),this.props.history.location.pathname=="/".concat(this.props.currentUser.id)&&this.props.history.push("/")}},{key:"goBack",value:function(){this.props.history.goBack()}},{key:"render",value:function(){var t,e=this.props.history.location.pathname,n=this.state,r=n.notifications,a=n.isOpen,s="/"==e?"btn-transparent btn-transparent--white":"btn-transparent",c=lt("/"==e?[J,"notification-icon"]:[q,"notification-icon--primary"],2),u=c[0],l=c[1];this.props.isLoggedIn&&(t="/".concat(this.props.currentUser.id));var p=!["/","/destinations","/review","/user"].some((function(t){return e==t}));return o.a.createElement(o.a.Fragment,null,o.a.createElement(G,null),o.a.createElement("div",{className:"main-nav"},p&&o.a.createElement("a",{onClick:this.goBack,className:"btn-arr btn-arr--left"},"← Back"),o.a.createElement("div",{className:"main-nav__content"},o.a.createElement("nav",{className:"main-nav__nav"},o.a.createElement(i.c,{exact:!0,to:"/",activeClassName:"btn-transparent--current",className:s},"Home"),o.a.createElement(i.c,{to:"/destinations",activeClassName:"btn-transparent--current",className:s},"Destinations"),o.a.createElement(i.c,{to:"/review",activeClassName:"btn-transparent--current",className:s},"Review")),!this.props.isLoggedIn&&o.a.createElement("div",{className:"main-nav__log-in-status"},o.a.createElement("a",{onClick:this.props.onOpen,className:"btn-primary"},"Log in")),this.props.isLoggedIn&&o.a.createElement("div",{className:"main-nav__log-in-status"},o.a.createElement("div",{className:"notification-container"},r.unSeenNotis>=1&&o.a.createElement("span",{className:"notification-number"},r.unSeenNotis),o.a.createElement(Q,{className:l,onClick:this.openNoti}),a&&o.a.createElement(ct,null)),o.a.createElement(i.c,{to:t,className:"btn-avatar"},o.a.createElement("img",{src:this.props.currentUser.avatar,className:"avatar-icon",alt:"Avatar"})),o.a.createElement("a",{className:"btn-logout",onClick:this.logout},o.a.createElement("img",{src:u,className:"logout-icon",alt:"Logout"}))))))}}])&&ft(e.prototype,n),r&&ft(e,r),s}(r.Component)))}}]);